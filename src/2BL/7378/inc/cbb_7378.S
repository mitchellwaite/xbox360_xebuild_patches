.include "macros.S"

.globl _start
_start:

.ifdef vfuses
#==================================================================================
#	Skips the entire fuse check routine by replacing the bl with a NOP
#==================================================================================
MAKEPATCH 0x000004F8
0:
	nop
9:
.else
#==================================================================================
# Disables VERIFY_SECOTP_6 - Verify 2BL Revocation - 2BL LDV mismatch
#==================================================================================
MAKEPATCH 0x0006d0c
0:
	nop
9:

#==================================================================================
# Disables VERIFY_SECOTP_9 - Verify Secure ROM 9
#==================================================================================
MAKEPATCH 0x0006e3c
0:
	b 0x18
9:
.endif

#==================================================================================
# Removes the random delays in the new-style CB_B
#==================================================================================
# 0x73d0 change 397df8f02b0bf8f0 to 397df9a02b0bf9a0
MAKEPATCH 0x000073D0
0:
	addi %r11, %r29, -0x660
	cmplwi cr6, %r11, 0xf9a0
9:

# 0x73ec change 2b160310 to 2b160260
MAKEPATCH 0x000073EC
0:
	cmplwi cr6, %r22, 0x260
9:

#0x75cc change e95e02f8e97e0300 to 3ff604004800005c
MAKEPATCH 0x000075CC
0:
	addis %r31, %r22, 0x400
	b 0x5c
9:

# 0x7820 change 7d8802a6 to 4e800020
MAKEPATCH 0x00007820
0:
	blr
9:

#==================================================================================
#	Disable CD hash check
#==================================================================================
MAKEPATCH 0x00008F50
0:
	li %r3, -1
	blr
9:

#============================================================================
	.long 0xFFFFFFFF
	.end
#============================================================================
